<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ë°©íƒˆì¶œ: ì•ˆì „í•œ êµì‹¤ ë§Œë“¤ê¸° (ìµœì¢… ì™„ì„±íŒ)</title>
    <style>
        /* --- ê¸°ë³¸ ë° ë ˆì´ì•„ì›ƒ ì„¤ì • --- */
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; font-family: 'Malgun Gothic', sans-serif; 
            background-color: #000;
        }
        #room-container { 
            position: relative; width: 100%; height: 100%; 
            transition: filter 0.5s;
        }
        #room-container img { 
            width: 100%; height: 100%; object-fit: contain; 
        }

        /* --- ìš°ì¸¡ ìƒë‹¨ UI (íƒ€ì´ë¨¸, ì •ë‹µ ë²„íŠ¼) --- */
        #top-right-ui {
            position: fixed; top: 15px; right: 15px; z-index: 5;
            display: none; /* ê²Œì„ ì‹œì‘ í›„ flexë¡œ ë³€ê²½ */
            flex-direction: row;
            align-items: center;
            gap: 15px; /* íƒ€ì´ë¨¸ì™€ ë²„íŠ¼ ì‚¬ì´ ê°„ê²© */
        }
        #game-timer {
            background-color: rgba(0, 0, 0, 0.6); color: white;
            font-size: 1.3em; font-weight: bold;
            padding: 10px 20px; border-radius: 10px;
            font-family: 'Courier New', monospace;
        }
        #answer-button {
            padding: 8px 15px; font-size: 0.9em; font-weight: bold;
            background-color: #6c757d; color: white;
            border-radius: 8px; border: none; cursor: pointer;
            transition: background-color 0.2s;
        }
        #answer-button:hover { background-color: #5a6268; }

        /* --- ì‹œì‘ í™”ë©´ ìŠ¤íƒ€ì¼ --- */
        #start-screen {
            position: fixed; z-index: 20; top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex; justify-content: center; align-items: center;
        }

        /* --- í´ë¦­ ê°€ëŠ¥ ì˜¤ë¸Œì íŠ¸ ìŠ¤íƒ€ì¼ --- */
        .clickable-object {
            position: absolute;
            cursor: pointer;
            transition: box-shadow 0.3s ease-in-out, background-color 0.3s ease-in-out;
            /* ì ì„  í…Œë‘ë¦¬ ì œê±°ë¨ */
        }
        .clickable-object:hover {
            background-color: rgba(255, 255, 0, 0.2);
            box-shadow: 0 0 15px 5px rgba(255, 255, 0, 0.7);
        }

        /* ì˜¤ë¸Œì íŠ¸ ìœ„ì¹˜ */
        #obj-chalkboard { top: 10%; left: 28%; width: 48%; height: 35%; }
        #obj-frame { top: 11%; left: 16%; width: 9%; height: 14%; }
        #obj-pencil { top: 60%; left: 28%; width: 11%; height: 9%; }
        #obj-chair { top: 57%; left: 45%; width: 15%; height: 32%; }
        #obj-door { top: 27%; left: 0; width: 13%; height: 60%; }

        /* --- ëª¨ë‹¬ íŒì—… ë° ê³µí†µ ìŠ¤íƒ€ì¼ --- */
        .modal-popup { display: none; position: fixed; z-index: 10; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); justify-content: center; align-items: center; padding: 10px; box-sizing: border-box; }
        .modal-content { background-color: #fff; padding: 30px; border-radius: 15px; width: 90%; max-width: 450px; text-align: center; position: relative; box-shadow: 0 5px 20px rgba(0,0,0,0.25); }
        .close-button { position: absolute; top: 10px; right: 20px; font-size: 32px; font-weight: bold; cursor: pointer; color: #aaa; }
        .hint { display: none; margin-top: 15px; font-weight: bold; color: #007bff; font-size: 1.1em; }
        input[type="text"], input[type="number"] { width: 80%; padding: 12px; margin: 8px 0; border: 1px solid #ccc; border-radius: 8px; text-align: center; font-size: 1em; }
        button { padding: 12px 25px; border: none; background-color: #007bff; color: white; border-radius: 8px; font-size: 1.1em; cursor: pointer; transition: background-color 0.2s; }
        button:hover { background-color: #0056b3; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        
        /* --- ë©”ëª¨ë¦¬ ê²Œì„ ìŠ¤íƒ€ì¼ --- */
        #memory-board { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 20px auto; max-width: 320px; perspective: 1000px; }
        .card { width: 100%; aspect-ratio: 1 / 1; position: relative; cursor: pointer; user-select: none; transform-style: preserve-3d; transition: transform 0.6s; }
        .card.flipped { transform: rotateY(180deg); }
        .card.matched { cursor: not-allowed; opacity: 0.5; }
        .card-face { position: absolute; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; font-size: 2.5em; border-radius: 10px; backface-visibility: hidden; }
        .card-front { background-color: #e8eaf6; color: #333; transform: rotateY(180deg); }
        .card-back { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-size: 1.5em; }
    </style>
</head>
<body>
    <!-- ìš°ì¸¡ ìƒë‹¨ UI -->
    <div id="top-right-ui">
        <button id="answer-button">ì •ë‹µ</button>
        <div id="game-timer">00:00</div>
    </div>
    
    <!-- ì‹œì‘ í™”ë©´ -->
    <div id="start-screen"><div class="modal-content"><h2>ë°©íƒˆì¶œ: ì•ˆì „í•œ êµì‹¤ ë§Œë“¤ê¸°</h2><p>í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ê¸° ì „, ë‹¹ì‹ ì˜ ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”.</p><input type="number" id="player-grade" placeholder="í•™ë…„"><input type="number" id="player-class" placeholder="ë°˜"><input type="text" id="player-name" placeholder="ì´ë¦„"><button id="start-game-button">í”„ë¡œì íŠ¸ ì‹œì‘</button></div></div>

    <!-- ë©”ì¸ ê²Œì„ í™”ë©´ -->
    <div id="room-container">
        <img src="https://i.ibb.co/PzwxG2CG/Whisk-storyboarde41407f036714026bfd3ce98.jpg" alt="êµì‹¤ ë°°ê²½">
        <div id="obj-chalkboard" class="clickable-object" title="ì¹ íŒ"></div>
        <div id="obj-frame" class="clickable-object" title="ì•¡ì"></div>
        <div id="obj-pencil" class="clickable-object" title="ì—°í•„"></div>
        <div id="obj-chair" class="clickable-object" title="ì˜ì"></div>
        <div id="obj-door" class="clickable-object" title="êµì‹¤ë¬¸"></div>
    </div>

    <!-- íŒì—… ëª¨ë‹¬ë“¤ -->
    <div id="frame-modal" class="modal-popup"><div class="modal-content"><span class="close-button">Ã—</span><h2>ì•¡ì ì† ë‹¤ì§</h2><p>ì•¡ìë¥¼ ë³´ë‹ˆ ì¤‘ìš”í•œ ì•½ì†ì´ ë– ì˜¤ë¥¸ë‹¤.<br>"ìš°ë¦¬ ì‚¬ì´ì˜ 'ê²½ê³„'ë¥¼ ì¡´ì¤‘í•˜ê² ë‹¤ëŠ” ì•½ì†."<br><br><strong>ë¹„ë°€ë²ˆí˜¸ì˜ ì²« ë²ˆì§¸ ìˆ«ìëŠ” 'ë‘˜(2)' ì‚¬ì´ì˜ ì•½ì†ì„ì„ ì˜ë¯¸í•œë‹¤.</strong></p></div></div>
    <div id="chalkboard-modal" class="modal-popup"><div class="modal-content"><span class="close-button">Ã—</span><h2>ì¹ íŒì˜ ê·œì¹™</h2><p>ì¹œêµ¬ê°€ ì¥ë‚œì´ë¼ë©° ë‚´ ë™ì˜ ì—†ì´ ë‚´ ì‚¬ì§„ì„ ì˜¨ë¼ì¸ì— ì˜¬ë¦¬ë ¤ê³  í•œë‹¤.<br>ì´ëŸ° í–‰ë™ì€ ëª‡ ë²ˆê¹Œì§€ í—ˆìš©ë  ìˆ˜ ìˆì„ê¹Œ?</p><input type="text" id="quiz1-answer" placeholder="ìˆ«ìë¡œ ì…ë ¥"><button id="submit-quiz1">í™•ì¸</button><p id="quiz1-hint" class="hint"></p></div></div>
    <div id="chair-modal" class="modal-popup"><div class="modal-content"><span class="close-button">Ã—</span><h2>ê°€ì¥ ì¤‘ìš”í•œ ì•½ì†</h2><p>ëª¨ë“  ê´€ê³„ì—ì„œ ê°€ì¥ ê¸°ë³¸ì´ ë˜ë©°, ìƒëŒ€ë°©ì˜ ì˜ì‚¬ë¥¼ ë¬»ê³  ì¡´ì¤‘í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ëŠ” ë‘ ê¸€ì ë‹¨ì–´ëŠ” ë¬´ì—‡ì¼ê¹Œ?</p><input type="text" id="quiz2-answer" placeholder="í•œê¸€ ë‘ ê¸€ì"><button id="submit-quiz2">í™•ì¸</button><p id="quiz2-hint" class="hint"></p></div></div>
    <div id="pencil-modal" class="modal-popup"><div class="modal-content"><span class="close-button">Ã—</span><h2>ì—°í•„ë¡œ ë°°ìš°ëŠ” ê°œë…ë“¤</h2><p>ì•ˆì „í•œ ê´€ê³„ë¥¼ ìœ„í•´ ê¼­ ì•Œì•„ì•¼ í•  ê°œë…ë“¤ì…ë‹ˆë‹¤. ê°™ì€ ì•„ì´ì½˜ì˜ ì¹´ë“œë¥¼ ë§ì¶°ì£¼ì„¸ìš”.</p><div id="memory-board"></div><p id="memory-hint" class="hint"></p></div></div>
    <div id="door-modal" class="modal-popup"><div class="modal-content"><span class="close-button">Ã—</span><h2>ì•ˆì „í•œ êµì‹¤ ë§Œë“¤ê¸°</h2><p>ë°°ìš´ ë‚´ìš©ìœ¼ë¡œ 4ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì™„ì„±í•˜ì„¸ìš”.</p><input type="text" id="final-password" maxlength="4" placeholder="ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬"><button id="submit-final">í”„ë¡œì íŠ¸ ì™„ë£Œ</button></div></div>
    
    <!-- ì—”ë”© í™”ë©´ -->
    <div id="outro-modal" class="modal-popup"><div class="modal-content"><h2 id="outro-title">í”„ë¡œì íŠ¸ ì„±ê³µ!</h2><p id="outro-time" style="font-size: 1.1em; color: #333;"></p><p>ìš°ë¦¬ê°€ í•¨ê»˜ ë°°ìš´ ì•ˆì „í•œ êµì‹¤ì„ ë§Œë“œëŠ” 4ê°€ì§€ ì•½ì†ì…ë‹ˆë‹¤.</p><ul style="text-align: left; margin: 20px auto; width: fit-content; line-height: 1.6;"><li>ğŸ–¼ï¸ ì„œë¡œì˜ ê²½ê³„ ì¡´ì¤‘í•˜ê¸°</li><li>ì¹ íŒì— ë‚™ì„œí•˜ì§€ ì•Šê¸° (ë™ì˜ ì—†ëŠ” ì´¬ì˜/ê³µìœ  ê¸ˆì§€)</li><li>ğŸª‘ ì•‰ì•„ì„œ ì§„ì†”í•˜ê²Œ 'ë™ì˜' êµ¬í•˜ê¸°</li><li>âœï¸ í•¨ê»˜ ë°°ìš°ê³  ì—°ëŒ€í•˜ê¸°</li></ul><p>ì´ ì•½ì†ë“¤ì„ ê¼­ ê¸°ì–µí•´ ì£¼ì„¸ìš”!</p><button id="close-outro-button">ë‹«ê¸°</button></div></div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- ì „ì—­ ë³€ìˆ˜ ë° ìš”ì†Œ ì´ˆê¸°í™” ---
        let playerName = '';
        const clues = new Set();
        const attemptCounters = { quiz1: 0, quiz2: 0, final: 0 };
        let startTime = 0;
        let timerInterval;

        const startScreen = document.getElementById('start-screen');
        const roomContainer = document.getElementById('room-container');
        const topRightUI = document.getElementById('top-right-ui');
        const timerDisplay = document.getElementById('game-timer');
        const answerButton = document.getElementById('answer-button');

        const modals = {};
        for (const key of ['frame', 'chalkboard', 'chair', 'pencil', 'door', 'outro']) {
            modals[key] = document.getElementById(`${key}-modal`);
        }
        
        roomContainer.style.filter = 'blur(5px)';

        // --- ì‹œì‘ í™”ë©´ ë¡œì§ ---
        document.getElementById('start-game-button').addEventListener('click', () => {
            const grade = document.getElementById('player-grade').value;
            const className = document.getElementById('player-class').value;
            const name = document.getElementById('player-name').value;
            if (!grade || !className || !name) {
                alert('í•™ë…„, ë°˜, ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!'); return;
            }
            playerName = name;
            startScreen.style.display = 'none';
            roomContainer.style.filter = 'none';
            
            topRightUI.style.display = 'flex'; // íƒ€ì´ë¨¸ì™€ ë²„íŠ¼ì´ ë‹´ê¸´ ì»¨í…Œì´ë„ˆ í‘œì‹œ
            startTime = Date.now();
            timerInterval = setInterval(updateTimer, 1000);
        });

        // íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateTimer() {
            const totalSeconds = Math.floor((Date.now() - startTime) / 1000);
            const minutes = String(Math.floor(totalSeconds / 60)).padStart(2, '0');
            const seconds = String(totalSeconds % 60).padStart(2, '0');
            timerDisplay.textContent = `${minutes}:${seconds}`;
        }
        
        // 'ì •ë‹µ ë³´ê¸°' ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        answerButton.addEventListener('click', () => {
            const userInput = prompt('ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
            if (userInput === '0935') {
                alert('ìµœì¢… ë¹„ë°€ë²ˆí˜¸ëŠ” [2025] ì…ë‹ˆë‹¤.');
            } else if (userInput !== null) { // ì‚¬ìš©ìê°€ 'ì·¨ì†Œ'ë¥¼ ëˆ„ë¥´ì§€ ì•Šì•˜ì„ ê²½ìš°
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.');
            }
        });

        // ì˜¤ë¸Œì íŠ¸ í´ë¦­ ì´ë²¤íŠ¸
        document.getElementById('obj-frame').addEventListener('click', () => { modals.frame.style.display = 'flex'; clues.add('2'); });
        document.getElementById('obj-chalkboard').addEventListener('click', () => modals.chalkboard.style.display = 'flex');
        document.getElementById('obj-chair').addEventListener('click', () => modals.chair.style.display = 'flex');
        document.getElementById('obj-pencil').addEventListener('click', () => {
            modals.pencil.style.display = 'flex';
            if (!clues.has('5')) createMemoryGame();
        });

        // ëª¨ë‹¬ ë‹«ê¸° ì´ë²¤íŠ¸
        document.querySelectorAll('.close-button').forEach(btn => btn.addEventListener('click', e => e.target.closest('.modal-popup').style.display = 'none'));
        document.getElementById('close-outro-button').addEventListener('click', () => modals.outro.style.display = 'none');

        // ë¬¸ì œ 1 & 2 ë¡œì§ (3íšŒ ì˜¤ë‹µ ì‹œ íŒíŠ¸ ì œê³µ)
        function setupQuiz(quizId, answer, hintText, clue) {
            document.getElementById(`submit-${quizId}`).addEventListener('click', e => {
                const input = document.getElementById(`${quizId}-answer`).value.trim();
                const hintElem = document.getElementById(`${quizId}-hint`);
                if (input === answer) {
                    hintElem.textContent = hintText.success;
                    hintElem.style.display = 'block'; clues.add(clue); e.target.disabled = true;
                } else {
                    attemptCounters[quizId]++;
                    if (attemptCounters[quizId] >= 3) {
                        alert(hintText.failAlert);
                        hintElem.textContent = hintText.failHint;
                        hintElem.style.display = 'block'; clues.add(clue); e.target.disabled = true;
                    } else { alert(`í‹€ë ¸ìŠµë‹ˆë‹¤. (ë‚¨ì€ ê¸°íšŒ: ${3 - attemptCounters[quizId]}ë²ˆ)`); }
                }
            });
        }
        setupQuiz('quiz1', '0', {
            success: "ì •ë‹µì…ë‹ˆë‹¤. ë™ì˜ ì—†ëŠ” ê³µìœ ëŠ” ë‹¨ í•œ ë²ˆë„ ì•ˆ ë¼ìš”. ë¹„ë°€ë²ˆí˜¸ì˜ ë‘ ë²ˆì§¸ ìˆ«ìëŠ” [0]ì…ë‹ˆë‹¤.",
            failAlert: "ì„¸ ë²ˆ ì´ìƒ í‹€ë ¸ìŠµë‹ˆë‹¤. ì •ë‹µì€ '0'ì…ë‹ˆë‹¤. ë™ì˜ ì—†ëŠ” ì´¬ì˜/ê³µìœ ëŠ” ì ˆëŒ€ í—ˆìš©ë˜ì§€ ì•Šì•„ìš”!",
            failHint: "íŒíŠ¸: ë¹„ë°€ë²ˆí˜¸ì˜ ë‘ ë²ˆì§¸ ìˆ«ìëŠ” [0]ì…ë‹ˆë‹¤."
        }, '0');
        setupQuiz('quiz2', 'ë™ì˜', {
            success: "ë§ì•„ìš”! 'ë™ì˜'ëŠ” ì¡´ì¤‘ì˜ ì‹œì‘ì…ë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ì˜ ì„¸ ë²ˆì§¸ ìˆ«ìëŠ” ë‹¨ì–´ì˜ ê¸€ì ìˆ˜ì¸ [2]ì…ë‹ˆë‹¤.",
            failAlert: "ì„¸ ë²ˆ ì´ìƒ í‹€ë ¸ìŠµë‹ˆë‹¤. ì •ë‹µì€ 'ë™ì˜'ì…ë‹ˆë‹¤.",
            failHint: "íŒíŠ¸: 'ë™ì˜'ëŠ” ì¡´ì¤‘ì˜ ì‹œì‘! ë¹„ë°€ë²ˆí˜¸ì˜ ì„¸ ë²ˆì§¸ ìˆ«ìëŠ” [2]ì…ë‹ˆë‹¤."
        }, '2-2');

        // ë©”ëª¨ë¦¬ ê²Œì„ ë¡œì§
        function createMemoryGame() {
            const board = document.getElementById('memory-board'), hint = document.getElementById('memory-hint');
            board.innerHTML = ''; hint.style.display = 'none';
            const cardIcons = ['ğŸ¤', 'ğŸ¤', 'ğŸš«', 'ğŸš«', 'ğŸ“¸', 'ğŸ“¸', 'â¤ï¸', 'â¤ï¸'];
            cardIcons.sort(() => 0.5 - Math.random());
            let flippedCards = [], matchedPairs = 0;
            cardIcons.forEach(icon => {
                const card = document.createElement('div'); card.classList.add('card'); card.dataset.icon = icon;
                const front = document.createElement('div'); front.classList.add('card-face', 'card-front'); front.textContent = icon;
                const back = document.createElement('div'); back.classList.add('card-face', 'card-back'); back.textContent = '?';
                card.appendChild(front); card.appendChild(back); board.appendChild(card);
                card.addEventListener('click', () => {
                    if (card.classList.contains('flipped') || card.classList.contains('matched') || flippedCards.length === 2) return;
                    card.classList.add('flipped'); flippedCards.push(card);
                    if (flippedCards.length === 2) {
                        if (flippedCards[0].dataset.icon === flippedCards[1].dataset.icon) {
                            flippedCards.forEach(c => c.classList.add('matched')); flippedCards = []; matchedPairs++;
                            if (matchedPairs === cardIcons.length / 2) {
                                hint.textContent = "ì„±ê³µ! ëª¨ë“  ê°œë…ì„ ìµí˜”ìŠµë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ì˜ ë§ˆì§€ë§‰ ìˆ«ìëŠ” ìš°ë¦¬ê°€ í•¨ê»˜ ì—°ëŒ€í•˜ìëŠ” ì˜ë¯¸ì˜ [5]ì…ë‹ˆë‹¤.";
                                hint.style.display = 'block'; clues.add('5');
                            }
                        } else { setTimeout(() => { flippedCards.forEach(c => c.classList.remove('flipped')); flippedCards = []; }, 1200); }
                    }
                });
            });
        }
        
        // ìµœì¢… íƒˆì¶œ ë¡œì§
        document.getElementById('obj-door').addEventListener('click', () => {
            if (clues.size < 4) { alert('ì•„ì§ êµì‹¤ì˜ ëª¨ë“  ì•½ì†ì„ í™•ì¸í•˜ì§€ ëª»í–ˆì–´ìš”!'); } 
            else { modals.door.style.display = 'flex'; }
        });

        document.getElementById('submit-final').addEventListener('click', () => {
            if (document.getElementById('final-password').value === '2025') {
                clearInterval(timerInterval);
                const finalTime = timerDisplay.textContent;
                document.getElementById('outro-title').textContent = `í”„ë¡œì íŠ¸ ì„±ê³µ, ${playerName}ë‹˜!`;
                document.getElementById('outro-time').textContent = `íƒˆì¶œ ì„±ê³µê¹Œì§€ ê±¸ë¦° ì‹œê°„: ${finalTime}`;
                modals.door.style.display = 'none';
                modals.outro.style.display = 'flex';
            } else {
                attemptCounters.final++;
                 if (attemptCounters.final >= 3) {
                    alert("ì„¸ ë²ˆ ì´ìƒ í‹€ë ¸ìŠµë‹ˆë‹¤. ìš°ë¦¬ê°€ ë°°ìš´ íŒíŠ¸ë“¤ì„ ìˆœì„œëŒ€ë¡œ ì¡°í•©í•´ ë³´ì„¸ìš”: (ì•¡ì) â†’ (ì¹ íŒ) â†’ (ì˜ì) â†’ (ì—°í•„)");
                } else {
                    alert(`ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤. (ë‚¨ì€ ê¸°íšŒ: ${3 - attemptCounters.final}ë²ˆ)`);
                }
            }
        });
    });
    </script>
</body>
</html>